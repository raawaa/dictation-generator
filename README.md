# 英语单词默写纸生成器

从 CSV 文件中抽取英语单词、短语和句子，生成 PDF 格式的默写纸。专为小学生英语学习设计，采用标准的英文练习本样式（四线格）。

## 📥 下载安装

### Windows 用户

**最简单的方式：直接下载使用**

1. 访问 [GitHub Releases 页面](https://github.com/raawaa/dictation-generator/releases)
2. 下载最新版本的 `dictation-generator-windows-v0.1.0.exe`
3. 双击运行即可使用

**系统要求：**
- Windows 10 或更高版本
- 无需安装 Python 或其他依赖

### macOS / Linux 用户

需要安装 Python 环境：

```bash
# 安装依赖
pip3 install PyQt6 reportlab

# 运行图形界面
python3 gui_main.py
```

## 🚀 快速开始

### Windows 用户（图形界面）

1. 双击运行 `dictation-generator-windows-v0.1.0.exe`
2. **选择 CSV 文件**：
   - 程序已内置示例词汇文件，可以直接使用
   - 也可以点击"选择 CSV 文件"按钮，选择自己的 CSV 文件
3. 选择要生成的单元（如 M1、M2、M3）
4. 可选：设置单词数量、类型筛选等
5. 点击"生成默写纸"按钮
6. 等待生成完成，PDF 文件会保存在当前目录

### macOS / Linux 用户（图形界面）

```bash
python3 gui_main.py
```

操作步骤与 Windows 版本相同。

## 📖 使用说明

### 图形界面操作

1. **选择 CSV 文件**
   - 程序已内置示例词汇文件，可以直接使用
   - 也可以点击"选择 CSV 文件"按钮，选择自己的 CSV 文件
   - 文件格式必须包含：中文、英文、单元、年级、类别

2. **选择单元**
   - 在"单元选择"区域勾选要生成的单元
   - 可以同时选择多个单元
   - 支持按年级筛选

3. **设置参数**
   - **单词数量**：输入要生成的单词数量（留空则生成全部）
   - **默写类型**：选择要生成的类型（单词、短语、句子）
   - **生成份数**：设置要生成几份不同的默写纸

4. **生成默写纸**
   - 点击"生成默写纸"按钮
   - 等待进度条完成
   - 生成的 PDF 文件会保存在当前目录

### 命令行使用（高级用户）

```bash
# 生成 M1 单元的全部词汇
python3 generate_dictation.py --unit M1

# 生成 M1 单元的 20 个随机单词
python3 generate_dictation.py --unit M1 --count 20

# 生成多个单元（M1、M2、M3）
python3 generate_dictation.py --units M1,M2,M3

# 只生成单词类型
python3 generate_dictation.py --unit M1 --type 单词

# 生成 3 份不同的默写纸
python3 generate_dictation.py --unit M2 --count 15 --copies 3

# 查看帮助
python3 generate_dictation.py --help
```

## 📝 数据文件格式

CSV 文件必须使用 UTF-8 编码，包含以下字段：

```csv
中文,英文,单元,年级,类别
遇到,meet,M1,四年级上半学期,单词
人们,people,M1,四年级上半学期,单词
展示一张你朋友的照片,show a photo of your friend,M1,四年级上半学期,短语
她的姓名是莎莉。,Her name is Sally.,M1,四年级上半学期,句子
```

**字段说明：**
- `中文`：中文翻译
- `英文`：英文单词/短语/句子
- `单元`：单元编号（如 M1、M2、M3）
- `年级`：年级信息
- `类别`：类型（单词、短语、句子）

## 📄 输出说明

### 文件命名

生成的 PDF 文件命名格式：`默写纸_{单元}_{日期}_{序号}.pdf`

例如：`默写纸_M1_20260120_01.pdf`

### PDF 内容

**第 1 页 - 默写页：**
- 标题：英语单词默写 - {单元名称}
- 信息行：日期、姓名、分数
- 按类型分组显示：
  - **一、单词**：一行 4 个
  - **二、短语**：一行 2 个
  - **三、句子**：一行 1 个
  - 每个词汇包含四线格（上）+ 中文（下）

**第 2 页 - 答案页：**
- 标题：英语单词默写答案 - {单元名称}
- 按类型分组显示答案

### 四线格样式

采用标准英文练习本样式：
- 从上到下：黑色实线、黑色实线、红色虚线（中间线）、黑色实线
- 线间距：0.3cm，适合小学生书写

## ❓ 常见问题

**Q: 需要自己准备 CSV 文件吗？**
A: 不需要。程序已内置示例词汇文件，可以直接使用。如果您想使用自己的词汇数据，可以准备一个符合格式的 CSV 文件并选择它。

**Q: 如何使用自己的 CSV 文件？**
A: 在程序中点击"选择 CSV 文件"按钮，选择您的 CSV 文件即可。文件格式请参考下方的"数据文件格式"部分。

**Q: 生成的 PDF 打印出来是空白的？**
A: 请确保使用 PDF 阅读器打开文件，不要用图片查看器。建议使用 Adobe Acrobat Reader 或系统自带的 PDF 查看器。

**Q: 中文显示乱码？**
A: CSV 文件必须使用 UTF-8 编码保存。可以使用 Excel 或文本编辑器另存为 UTF-8 格式。

**Q: 可以自定义四线格样式吗？**
A: 目前四线格样式是固定的，如需修改可以联系开发者或自己修改源代码。

**Q: Windows 版本运行时提示安全警告？**
A: 这是 Windows 的安全机制，可以点击"更多信息"然后选择"仍要运行"。

## 📞 技术支持

- GitHub Issues：https://github.com/raawaa/dictation-generator/issues
- 作者：raawaa

## 📜 开源协议

本项目采用 MIT 开源协议。